DBid,Original_Query
bike_1,"SELECT ( SELECT COUNT ( * ) FROM station WHERE city = 'Palo Alto' ) - COUNT ( * ) AS diff FROM station WHERE city = 'San Francisco'"
bike_1,"SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM station WHERE city = 'San Francisco' ) AS propotion FROM station WHERE city = 'San Francisco' AND dock_count > 25"
driving_school,"SELECT A.staff_id , AVG ( A.price ) - ( SELECT AVG ( price ) FROM Lessons GROUP BY staff_id ORDER BY AVG ( price ) ASC LIMIT 1 ) AS diff FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id GROUP BY A.staff_id ORDER BY AVG ( A.price ) DESC LIMIT 1"
driving_school,"SELECT staff_id , AVG ( price ) - ( SELECT AVG ( price ) FROM ( SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price * ( 1 - 0.12 ) AS price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' UNION ALL SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE NOT ( B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' ) ) GROUP BY staff_id ORDER BY AVG ( price ) ASC LIMIT 1 ) AS diff FROM ( SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price * ( 1 - 0.12 ) AS price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' UNION ALL SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE NOT ( B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' ) ) GROUP BY staff_id ORDER BY AVG ( price ) DESC LIMIT 1"
formula_1,"SELECT 1.0 * ( SELECT COUNT ( * ) FROM circuits WHERE country = 'USA' ) / COUNT ( * ) AS ratio FROM circuits WHERE country = 'Russia'"
formula_1,"SELECT 1.0 * COUNT ( * ) / ( SELECT 1.0 * COUNT ( * ) FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'UK' ) AS ratio FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'USA'"
hospital_1,"SELECT COUNT ( DISTINCT ( Patient ) ) - ( SELECT COUNT ( DISTINCT ( Patient ) ) FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Baz Industries' ) AS diff FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Foo Labs'"
hospital_1,"SELECT A.Name , A.Position , 50 * COUNT ( * ) AS cost FROM Physician A JOIN Trained_In B ON A.EmployeeID = B.Physician GROUP BY A.EmployeeID HAVING COUNT ( * ) = ( SELECT MAX ( training_count ) FROM ( SELECT COUNT ( * ) AS training_count FROM Trained_In GROUP BY Physician ) )"
hospital_1,"SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MIN ( BlockFloor ) FROM Room ) ) AS diff FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MAX ( BlockFloor ) FROM Room )"
riding_club,"SELECT 100.0 * ( COUNT ( * ) + 1 ) / ( SELECT COUNT ( * ) FROM club ) AS ratio FROM club WHERE Start_year < '2009' AND Club_name != 'Helsingborgs IF'"
riding_club,"SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' ) AS prob FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Rank = '1st'"
riding_club,"SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Player_name = 'Fiona Shiells' ) ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' ) AS prob FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Rank = '1st' AND A.Player_name != 'Fiona Shiells'"
riding_club,"SELECT 100.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM club WHERE Region = 'USA' ) ) / ( SELECT COUNT ( * ) FROM club ) AS percent FROM club WHERE Start_year < 2001 AND Region != 'USA'"
riding_club,"SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) ) AS ratio FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND Rank = '1st'"
riding_club,"SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) - ( SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND ( Rank = '1st' OR Rank = '2nd' ) ) AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' )"
wine_1,"SELECT MAX ( Price ) - MIN ( Price ) AS diff FROM ( SELECT price * ( 1 + 0.1 ) AS price , Score FROM wine WHERE Winery = 'Carlisle' UNION ALL SELECT price , Score FROM wine WHERE Winery != 'Carlisle' ) WHERE Score = '98'"
wine_1,"SELECT Winery , Price - ( SELECT AVG ( Price ) FROM wine WHERE name = 'Cabernet Sauvignon' ) AS diff FROM wine WHERE name = 'Cabernet Sauvignon' AND Score = ( SELECT MAX ( Score ) FROM wine WHERE name = 'Cabernet Sauvignon' )"
wine_1,"SELECT Winery , Price - ( SELECT AVG ( Price ) FROM wine WHERE name = 'Cabernet Sauvignon' ) AS diff FROM ( SELECT Winery , Price , Score - 10 AS Score , Name FROM wine WHERE Year = '2005' UNION ALL SELECT Winery , Price , Score , Name FROM wine WHERE Year != '2005' ) WHERE name = 'Cabernet Sauvignon' AND Score = ( SELECT MAX ( Score ) FROM ( SELECT Winery , Price , Score - 10 AS Score , Name FROM wine WHERE Year = '2005' UNION ALL SELECT Winery , Price , Score , Name FROM wine WHERE Year != '2005' ) WHERE name = 'Cabernet Sauvignon' )"
wine_1,"SELECT 100.0 * COUNT ( DISTINCT ( Winery ) ) / ( SELECT COUNT ( DISTINCT ( Winery ) ) FROM wine ) AS percent FROM ( SELECT A.Winery , A.No , A.Year , A.Score , B.No , B.Year , B.Score , C.No , C.Year , C.Score FROM wine A JOIN wine B ON A.Winery = B.Winery JOIN wine C ON A.Winery = C.Winery WHERE A.Score >= 90 AND B.Score >= 90 AND C.Score >= 90 AND B.Year - A.Year = 1 AND C.Year - B.Year = 1 )"
wine_1,"SELECT 100.0 * COUNT ( DISTINCT ( Winery ) ) / ( SELECT COUNT ( DISTINCT ( Winery ) ) FROM wine ) AS percent FROM ( SELECT A.Winery , A.No , A.Year , A.Score , B.No , B.Year , B.Score , C.No , C.Year , C.Score FROM ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) A JOIN ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) B ON A.Winery = B.Winery JOIN ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) C ON A.Winery = C.Winery WHERE A.Score >= 90 AND B.Score >= 90 AND C.Score >= 90 AND B.Year - A.Year = 1 AND C.Year - B.Year = 1 )"
world_1,"SELECT Name FROM ( SELECT Name , Code , GNP , GNPOld + 9999.0 AS GNPOld FROM country WHERE Continent = 'South America' UNION ALL SELECT Name , Code , GNP , GNPOld FROM country WHERE Continent != 'South America' ) WHERE Code NOT IN ( SELECT CountryCode FROM countrylanguage WHERE Language = 'Arabic' AND IsOfficial = 'T' ) ORDER BY 100.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
world_1,"SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM country WHERE GNP < GNPOld AND Continent = 'South America' ) AS diff FROM country WHERE GNP < GNPOld AND Continent = 'North America'"
world_1,"SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM country WHERE GNP < GNPOld AND Continent = 'South America' ) AS diff FROM ( SELECT Name , GNP * ( 1 + 0.02 ) AS GNP , GNPOld , Continent FROM country WHERE Continent = 'North America' AND Code IN ( SELECT Code FROM country WHERE Continent = 'North America' ORDER BY Population DESC LIMIT 2 ) UNION ALL SELECT Name , GNP , GNPOld , Continent FROM country WHERE Continent = 'North America' AND Code NOT IN ( SELECT Code FROM country WHERE Continent = 'North America' ORDER BY Population DESC LIMIT 2 ) ) WHERE GNP < GNPOld AND Continent = 'North America'"
world_1,"SELECT Population * ( 1 + 0.004 ) AS population_in_1year FROM ( SELECT Continent , name , 103000 AS Population FROM country WHERE Continent = 'Europe' AND LifeExpectancy > 75 UNION SELECT Continent , name , Population FROM country WHERE Continent = 'Europe' AND LifeExpectancy <= 75 ) WHERE name = 'United Kingdom'"
world_1,"SELECT CAST ( IndepYear + LifeExpectancy AS INT ) AS death_year FROM ( SELECT name , IndepYear , LifeExpectancy + 10 AS LifeExpectancy FROM country WHERE 1.0 * GNP / Population > ( SELECT 1.0 * SUM ( GNP ) / SUM ( Population ) FROM country WHERE Continent = 'Europe' ) UNION ALL SELECT name , IndepYear , LifeExpectancy FROM country WHERE NOT ( 1.0 * GNP / Population > ( SELECT 1.0 * SUM ( GNP ) / SUM ( Population ) FROM country WHERE Continent = 'Europe' ) ) ) WHERE name = 'Zambia'"
