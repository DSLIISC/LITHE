Queryid,Rewritten_Query
3,"WITH stackoverflow_authentication AS ( SELECT a1.owner_user_id, u1.account_id FROM tag t1 JOIN site s1 ON t1.site_id = s1.site_id JOIN question q1 ON q1.site_id = s1.site_id JOIN tag_question tq1 ON tq1.site_id = s1.site_id AND tq1.question_id = q1.id AND tq1.tag_id = t1.id JOIN answer a1 ON a1.site_id = q1.site_id AND a1.question_id = q1.id JOIN so_user u1 ON a1.owner_user_id = u1.id AND a1.site_id = u1.site_id WHERE s1.site_name = 'stackoverflow' AND t1.name = 'authentication' ), physics_quantum_mechanics AS ( SELECT q2.owner_user_id, u2.account_id FROM tag t2 JOIN site s2 ON t2.site_id = s2.site_id JOIN question q2 ON q2.site_id = s2.site_id JOIN tag_question tq2 ON tq2.site_id = s2.site_id AND tq2.question_id = q2.id AND tq2.tag_id = t2.id JOIN so_user u2 ON q2.owner_user_id = u2.id AND q2.site_id = u2.site_id WHERE s2.site_name = 'physics' AND t2.name = 'quantum-mechanics' ) SELECT COUNT(DISTINCT account.display_name) FROM stackoverflow_authentication sa JOIN physics_quantum_mechanics pq ON sa.account_id = pq.account_id JOIN account ON account.id = sa.account_id;"
12," WITH filtered_tag_question AS ( SELECT * FROM tag_question WHERE tag_id IN ( SELECT id FROM tag WHERE name IN ('customs-and-immigration','indian-citizens','magic-items','pathfinder-1e','schengen','spells','usa') ) AND site_id IN ( SELECT site_id FROM site WHERE site_name IN ('academia','rpg','travel') ) ) SELECT t1.name, count(*) FROM site AS s, so_user AS u1, question AS q1, answer AS a1, tag AS t1, filtered_tag_question AS tq1 WHERE q1.owner_user_id = u1.id AND a1.question_id = q1.id AND a1.owner_user_id = u1.id AND s.site_id = q1.site_id AND s.site_id = a1.site_id AND s.site_id = u1.site_id AND s.site_id = tq1.site_id AND s.site_id = t1.site_id AND q1.id = tq1.question_id AND t1.id = tq1.tag_id AND (s.site_name IN ('academia','rpg','travel')) AND (t1.name IN ('customs-and-immigration','indian-citizens','magic-items','pathfinder-1e','schengen','spells','usa')) AND (q1.score >= 1) AND (q1.score <= 10) AND (u1.upvotes >= 10) AND (u1.upvotes <= 1000000) GROUP BY t1.name;"
