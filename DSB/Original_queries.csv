Queryid,Original_Query
1," with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =2001 and i_category IN ('Jewelry', 'Sports') and i_manager_id BETWEEN 0 and 1000 and inv_quantity_on_hand between 0 and 1000 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk = inv2.w_warehouse_sk and inv1.d_moy=8 and inv2.d_moy=8 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov ;"
2,"  select min(i_item_id), min(s_state), min(ss_quantity), min(ss_list_price), min(ss_coupon_amt), min(ss_sales_price), min(ss_item_sk), min(ss_ticket_number) from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'U' and cd_education_status = '2 yr Degree' and d_year = 1999 and s_state = 'IA' and i_category = 'Music' ;"
3,"  select i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Sports' and d_year=1999 and d_moy = 5 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'MD' and c_birth_month = 12 and ss_wholesale_cost BETWEEN 0 AND 100 group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100 ;"
4," select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1205 and 1205+110 and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 1 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1205 and 1205+110 and ss_sales_price / ss_list_price BETWEEN 42 * 0.01 AND 52 * 1 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue <= 100 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk and i_manager_id BETWEEN 0 and 100 and s_state in ('TN','KY','MO') order by s_store_name, i_item_desc limit 100 ;"
5," select min(i_item_id) ,min(i_item_desc) ,min(s_store_id) ,min(s_store_name) ,min(ss_net_profit) ,min(sr_net_loss) ,min(cs_net_profit) ,min(ss_item_sk) ,min(sr_ticket_number) ,min(cs_order_number) from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 3 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy between 3 and 3 + 2 and d2.d_year = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy between 3 and 3 + 2 and d3.d_year = 2000 ;"
6,"  with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =2000 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'IN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return limit 100 ;"
7," select min(i_item_id), min(ca_country), min(ca_state), min(ca_county), min(cs_quantity), min(cs_list_price), min(cs_coupon_amt), min(cs_sales_price), min(cs_net_profit), min(c_birth_year), min(cd_dep_count) from catalog_sales, customer_demographics, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd_gender = 'M' and cd_education_status = 'Advanced Degree' and c_current_addr_sk = ca_address_sk and d_year = 2001 and c_birth_month = 8 and ca_state in ('IN', 'MT', 'TX') and cs_wholesale_cost BETWEEN 95 AND 100 AND i_category = 'Electronics' ;"
8,"select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2000-04-09' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2000-04-09' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2000-06-01' as date) - interval '30 day') and (cast ('2000-06-01' as date) + interval '30 day') and i_category = 'Women' and i_manager_id between 0 and 1000 and cs_wholesale_cost between 0 and 1000 and cr_reason_sk = 23 group by w_state,i_item_id order by w_state,i_item_id limit 100 ;"
9,"select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = 'Advanced Degree' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'U' and cd_education_status = '4 yr Degree' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'S' and cd_education_status = 'Advanced Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('NC', 'TN', 'WI') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('GA', 'KY', 'LA') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'MN', 'TN') and ss_net_profit between 50 and 250 )) ;"
10,"select substring(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end) as "" 30 days"",sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end ) as ""31-60 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end) as "61-90 days" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end) as ""91-120 days"" ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 120) then 1 else 0 end) as "">120 days"" from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 24 and 53 and sm_type = 'LIBRARY' and cc_class = 'large' and w_gmt_offset = -5 group by substring(w_warehouse_name,1,20) ,sm_type ,cc_name order by substring(w_warehouse_name,1,20) ,sm_type ,cc_name limit 100 ;"
11," select min(w_warehouse_name) ,min(sm_type) ,min(cc_name) ,min(cs_order_number) ,min(cs_item_sk) from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1185 and 1185 + 23 and cs_ship_date_sk = d_date_sk and cs_warehouse_sk = w_warehouse_sk and cs_ship_mode_sk = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk and cs_list_price between 136 and 165 and sm_type = 'EXPRESS' and cc_class = 'large' and w_gmt_offset = -5 ;"
12," select count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209+11 and ss_list_price between 271 and 300 and c_birth_year BETWEEN 1942 AND 1948 and ss_wholesale_cost BETWEEN 38 AND 48 ) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209+11 and cs_list_price between 271 and 300 and c_birth_year BETWEEN 1942 AND 1948 and cs_wholesale_cost BETWEEN 38 AND 48 ) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1209 and 1209+11 and ws_list_price between 271 and 300 and c_birth_year BETWEEN 1942 AND 1948 and ws_wholesale_cost BETWEEN 38 AND 48 ) ) cool_cust ;"
13," select min(ss_quantity) ,min(ss_ext_sales_price) ,min(ss_ext_wholesale_cost) ,min(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'College' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Unknown' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IA', 'MN', 'VA') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AL', 'OH', 'OR') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('AR', 'AZ', 'WY') and ss_net_profit between 50 and 250 )) ;"
14,"select i_item_id, s_state, grouping(s_state) g_state, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and d_year = 2002 and s_state = 'NE' and i_category = 'Books' group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100 ;"
15," select min(s_store_name) ,min(s_company_id) ,min(s_street_number) ,min(s_street_name) ,min(s_suite_number) ,min(s_city) ,min(s_zip) ,min(ss_ticket_number) ,min(ss_sold_date_sk) ,min(sr_returned_date_sk) ,min(ss_item_sk) ,min(d1.d_date_sk) from store_sales ,store_returns ,store ,date_dim d1 ,date_dim d2 where d2.d_moy = 5 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk = d1.d_date_sk and sr_returned_date_sk = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk and sr_store_sk = s_store_sk and d1.d_date between (d2.d_date - interval '120 day') and d2.d_date and d1.d_dow = 2 and s_state in ('AR','IL','TX') ;"
16,"select count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223 + 11 and c_birth_month in (5, 7, 10, 12) and ss_list_price between 111 and 170 and ss_wholesale_cost BETWEEN 78 AND 98 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223 + 11 and c_birth_month in (5, 7, 10, 12) and cs_list_price between 111 and 170 and cs_wholesale_cost BETWEEN 78 AND 98 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1223 and 1223 + 11 and c_birth_month in (5, 7, 10, 12) and ws_list_price between 111 and 170 and ws_wholesale_cost BETWEEN 78 AND 98 ) hot_cust limit 100 ;"
17," with frequent_ss_items as (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year = 1999 and i_manager_id BETWEEN 6 and 25 AND i_category IN ('Home', 'Jewelry', 'Women') group by substring(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 1999 and ss_wholesale_cost BETWEEN 2 AND 12 group by c_customer_sk) tmp1), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk and c_birth_year BETWEEN 1929 AND 1935 group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select sum(sales) from (select cs_quantity*cs_list_price sales from catalog_sales ,date_dim where d_year = 1999 and d_moy = 2 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_wholesale_cost BETWEEN 2 AND 12 union all select ws_quantity*ws_list_price sales from web_sales ,date_dim where d_year = 1999 and d_moy = 2 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_wholesale_cost BETWEEN 2 AND 12) tmp2 limit 100 ;"
18," select min(ss_item_sk), min(ss_ticket_number), min(ws_order_number), min(c_customer_sk), min(cd_demo_sk), min(hd_demo_sk) from store_sales, web_sales, date_dim d1, date_dim d2, customer, inventory, store, warehouse, item, customer_demographics, household_demographics, customer_address where ss_item_sk = i_item_sk and ws_item_sk = ss_item_sk and ss_sold_date_sk = d1.d_date_sk and ws_sold_date_sk = d2.d_date_sk and d2.d_date between d1.d_date and (d1.d_date + interval '30 day') and ss_customer_sk = c_customer_sk and ws_bill_customer_sk = c_customer_sk and ws_warehouse_sk = inv_warehouse_sk and ws_warehouse_sk = w_warehouse_sk and inv_item_sk = ss_item_sk and inv_date_sk = ss_sold_date_sk and inv_quantity_on_hand >= ss_quantity and s_state = w_state AND i_category IN ('Children', 'Jewelry', 'Music') and i_manager_id IN (7, 11, 33, 42, 54, 64, 66, 75, 79, 93) and c_current_cdemo_sk = cd_demo_sk and c_current_hdemo_sk = hd_demo_sk and c_current_addr_sk = ca_address_sk and ca_state in ('IL', 'MI', 'MN', 'MS', 'NE') and d1.d_year = 1999 and ws_wholesale_cost BETWEEN 80 AND 100 ;"
19," select min(c_customer_sk), min(ss_item_sk), min(sr_ticket_number), min(ws_order_number) FROM store_sales, store_returns, web_sales, date_dim d1, date_dim d2, item, customer, customer_address, household_demographics WHERE ss_ticket_number = sr_ticket_number AND ss_customer_sk = ws_bill_customer_sk AND ss_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND c_current_hdemo_sk = hd_demo_sk AND ss_item_sk = sr_item_sk AND sr_item_sk = ws_item_sk AND i_item_sk = ss_item_sk AND i_category IN ('Men', 'Shoes', 'Women') AND sr_returned_date_sk = d1.d_date_sk AND ws_sold_date_sk = d2.d_date_sk AND d2.d_date between d1.d_date AND (d1.d_date + interval '90 day') AND ca_state in ('IN', 'KY', 'SD', 'TX', 'VA') AND d1.d_year = 2000 AND hd_income_band_sk BETWEEN 6 AND 12 AND hd_buy_potential = '5001-10000' AND ss_sales_price / ss_list_price BETWEEN 33 * 0.01 AND 53 * 0.01 ;"
20," select min(i_brand_id), min(i_manufact_id), min(ss_ext_sales_price) from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ss_store_sk = s_store_sk AND i_category = 'Children' and d_year=2001 and d_moy = 11 and substring(ca_zip,1,5) <> substring(s_zip,1,5) and ca_state = 'VA' and c_birth_month = 11 and ss_wholesale_cost BETWEEN 28 AND 48 ;"
