Queryid,Rewritten Query
6b," WITH filtered_mk AS ( SELECT * FROM movie_keyword WHERE keyword_id IN (SELECT id FROM keyword WHERE keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence')) ) SELECT MIN(k.keyword) AS movie_keyword, MIN(n.name) AS actor_name, MIN(t.title) AS hero_movie FROM cast_info AS ci, filtered_mk AS mk, keyword AS k, name AS n, title AS t WHERE k.keyword IN ('superhero', 'sequel', 'second-part', 'marvel-comics', 'based-on-comic', 'tv-special', 'fight', 'violence') AND n.name LIKE '%Downey%Robert%' AND t.production_year > 2014 AND k.id = mk.keyword_id AND t.id = mk.movie_id AND t.id = ci.movie_id AND ci.movie_id = mk.movie_id AND n.id = ci.person_id; "
7c,"  WITH filtered_names AS ( SELECT n.id, n.name FROM name AS n JOIN aka_name AS an ON n.id = an.person_id WHERE an.name IS NOT NULL AND (an.name LIKE '%a%' OR an.name LIKE 'A%') AND n.name_pcode_cf BETWEEN 'A' AND 'F' AND (n.gender = 'm' OR (n.gender = 'f' AND n.name LIKE 'A%')) ), filtered_links AS ( SELECT ml.linked_movie_id, lt.id AS link_type_id FROM movie_link AS ml JOIN link_type AS lt ON lt.id = ml.link_type_id WHERE lt.link IN ('references', 'referenced in', 'features', 'featured in') ), filtered_person_info AS ( SELECT pi.person_id, pi.info_type_id, pi.note FROM person_info AS pi JOIN info_type AS it ON it.id = pi.info_type_id WHERE it.info = 'mini biography' AND pi.note IS NOT NULL ), filtered_movies AS ( SELECT t.id FROM title AS t WHERE t.production_year BETWEEN 1980 AND 2010 ) SELECT MIN(n.name) AS cast_member_name, MIN(pi.note) AS cast_member_info FROM filtered_names AS n JOIN cast_info AS ci ON ci.person_id = n.id JOIN filtered_person_info AS pi ON pi.person_id = n.id JOIN filtered_movies AS t ON t.id = ci.movie_id JOIN filtered_links AS ml ON ml.linked_movie_id = t.id WHERE pi.person_id = ci.person_id AND ci.movie_id = ml.linked_movie_id; "
27c," SELECT MIN(cn.name) AS producing_company, MIN(lt.link) AS link_type, MIN(t.title) AS complete_western_sequel FROM complete_cast AS cc JOIN comp_cast_type AS cct1 ON cct1.id = cc.subject_id JOIN comp_cast_type AS cct2 ON cct2.id = cc.status_id JOIN movie_companies AS mc ON cc.movie_id = mc.movie_id JOIN company_name AS cn ON mc.company_id = cn.id JOIN company_type AS ct ON mc.company_type_id = ct.id JOIN movie_link AS ml ON cc.movie_id = ml.movie_id JOIN link_type AS lt ON ml.link_type_id = lt.id JOIN movie_keyword AS mk ON cc.movie_id = mk.movie_id JOIN keyword AS k ON mk.keyword_id = k.id JOIN movie_info AS mi ON cc.movie_id = mi.movie_id JOIN title AS t ON cc.movie_id = t.id WHERE cct1.kind = 'cast' AND cct2.kind LIKE 'complete%' AND cn.country_code != '[pl]' AND (cn.name LIKE '%Film%' OR cn.name LIKE '%Warner%') AND ct.kind = 'production companies' AND k.keyword = 'sequel' AND lt.link LIKE '%follow%' AND mc.note IS NULL AND mi.info IN ('Sweden', 'Norway', 'Germany', 'Denmark', 'Swedish', 'Denish', 'Norwegian', 'German', 'English') AND t.production_year BETWEEN 1950 AND 2010; "
10c," SELECT chn.name AS character, t.title AS movie_with_american_producer FROM char_name AS chn JOIN cast_info AS ci ON chn.id = ci.person_role_id JOIN title AS t ON t.id = ci.movie_id JOIN movie_companies AS mc ON t.id = mc.movie_id JOIN company_name AS cn ON cn.id = mc.company_id JOIN company_type AS ct ON ct.id = mc.company_type_id JOIN role_type AS rt ON rt.id = ci.role_id WHERE ci.note LIKE '%(producer)%' AND cn.country_code = '[us]' AND t.production_year > 1990 ORDER BY chn.name, t.title LIMIT 1; "
7a," SELECT MIN(n.name) AS of_person, MIN(t.title) AS biography_movie FROM aka_name AS an JOIN name AS n ON n.id = an.person_id JOIN person_info AS pi ON pi.person_id = n.id JOIN cast_info AS ci ON ci.person_id = n.id JOIN title AS t ON t.id = ci.movie_id JOIN movie_link AS ml ON ml.linked_movie_id = t.id JOIN link_type AS lt ON lt.id = ml.link_type_id JOIN info_type AS it ON it.id = pi.info_type_id WHERE an.name LIKE '%a%' AND it.info = 'mini biography' AND lt.link = 'features' AND n.name_pcode_cf BETWEEN 'A' AND 'F' AND (n.gender = 'm' OR (n.gender = 'f' AND n.name LIKE 'B%')) AND pi.note = 'Volker Boehm' AND t.production_year BETWEEN 1980 AND 1995; "
